import random

# Создаем словарь с правилами игры
# Ключ - это выбор игрока/компьютера
# Значение - это список вариантов, которые данный выбор побеждает
rules = {
    "камень": ["ножницы", "ящерица"],        # Камень побеждает ножницы и ящерицу
    "ножницы": ["бумага", "ящерица"],        # Ножницы побеждают бумагу и ящерицу
    "бумага": ["камень", "спок"],            # Бумага побеждает камень и Спока
    "ящерица": ["бумага", "спок"],           # Ящерица побеждает бумагу и Спока
    "спок": ["камень", "ножницы"]            # Спок побеждает камень и ножницы
}

# Создаем словарь с описаниями побед
# Здесь храним красивые фразы для каждого случая победы
win_messages = {
    "камень-ножницы": "Камень затупляет ножницы!",
    "камень-ящерица": "Камень давит ящерицу!",
    "ножницы-бумага": "Ножницы режут бумагу!",
    "ножницы-ящерица": "Ножницы убивают ящерицу!",
    "бумага-камень": "Бумага накрывает камень!",
    "бумага-спок": "Бумага подставляет Спока!",
    "ящерица-бумага": "Ящерица ест бумагу!",
    "ящерица-спок": "Ящерица травит Спока!",
    "спок-камень": "Спок испаряет камень!",
    "спок-ножницы": "Спок ломает ножницы!"
}

# Список допустимых вариантов для проверки ввода пользователя
valid_choices = ["камень", "ножницы", "бумага", "ящерица", "спок"]

# Функция для получения хода компьютера
def get_computer_choice():
    # random.choice выбирает случайный элемент из списка
    return random.choice(valid_choices)

# Функция для получения хода пользователя
def get_player_choice():
    while True:  # Бесконечный цикл, пока пользователь не введет правильный вариант
        # Получаем ввод от пользователя и убираем лишние пробелы, переводим в нижний регистр
        choice = input("Ваш ход (камень/ножницы/бумага/ящерица/спок): ").lower().strip()
        
        # Проверяем, есть ли введенный вариант в списке допустимых
        if choice in valid_choices:
            return choice  # Если вариант правильный, возвращаем его
        else:
            # Если вариант неправильный, просим ввести снова
            print("Неверный ввод! Пожалуйста, выберите из: камень, ножницы, бумага, ящерица, спок")

# Функция для определения победителя в одном раунде
def determine_winner(player_choice, computer_choice):
    # Если выборы одинаковые - ничья
    if player_choice == computer_choice:
        return "ничья"
    
    # Проверяем, побеждает ли выбор игрока выбор компьютера
    # Смотрим в словаре rules: если computer_choice есть в списке побеждаемых player_choice
    if computer_choice in rules[player_choice]:
        return "игрок"  # Игрок победил
    else:
        return "компьютер"  # Компьютер победил

# Функция для получения красивого сообщения о результате
def get_result_message(player_choice, computer_choice, winner):
    if winner == "ничья":
        return f"Оба выбрали {player_choice}. Ничья!"
    elif winner == "игрок":
        # Формируем ключ для словаря win_messages
        key = f"{player_choice}-{computer_choice}"
        return win_messages[key] + " Вы победили!"
    else:
        # Формируем ключ для словаря win_messages (меняем местами)
        key = f"{computer_choice}-{player_choice}"
        return win_messages[key] + " Компьютер победил!"

# Основная функция игры
def play_game():
    print("Добро пожаловать в игру 'Камень-Ножницы-Бумага-Ящерица-Спок'!")
    
    # Спрашиваем, до скольки побед играем
    while True:
        try:
            # Пробуем преобразовать ввод в число
            wins_needed = int(input("До скольки побед играем? "))
            if wins_needed > 0:  # Проверяем, что число положительное
                break
            else:
                print("Число должно быть больше 0!")
        except ValueError:
            # Если введено не число, выводим сообщение об ошибке
            print("Пожалуйста, введите целое число!")
    
    # Инициализируем счетчики побед
    player_wins = 0
    computer_wins = 0
    
    # Играем пока кто-то не наберет нужное количество побед
    while player_wins < wins_needed and computer_wins < wins_needed:
        print(f"\n--- Счет: Вы – {player_wins}, Компьютер – {computer_wins} ---")
        
        # Получаем ходы игрока и компьютера
        player_choice = get_player_choice()
        computer_choice = get_computer_choice()
        
        print(f"Ход компьютера: {computer_choice}")
        
        # Определяем победителя раунда
        winner = determine_winner(player_choice, computer_choice)
        
        # Получаем и выводим сообщение о результате
        result_message = get_result_message(player_choice, computer_choice, winner)
        print(result_message)
        
        # Обновляем счетчики побед
        if winner == "игрок":
            player_wins += 1
        elif winner == "компьютер":
            computer_wins += 1
    
    # Выводим финальный результат игры
    print(f"\n=== ИГРА ОКОНЧЕНА ===")
    print(f"Финальный счет: Вы – {player_wins}, Компьютер – {computer_wins}")
    
    if player_wins > computer_wins:
        print("Поздравляем! Вы выиграли игру!")
    else:
        print("Компьютер выиграл игру. Попробуйте еще раз!")

# Запускаем игру, если этот файл запущен напрямую
if __name__ == "__main__":
    play_game()